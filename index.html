<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eduport App Redirection</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
        }
        .redirect-message {
            margin-top: 50px;
            font-size: 18px;
        }
    </style>
</head>
<body>
    <div class="redirect-message" id="redirectMessage">
        Redirecting to Eduport ...
    </div>
    <script>
        // App store URLs
        const PLAY_STORE_URL = 'https://play.google.com/store/apps/details?id=com.eduport.app';
        const APP_STORE_URL = 'https://apps.apple.com/app/eduport/id123456789';
        const DEFAULT_REDIRECT_URL = 'https://eduportlms.page.link/getapp';

        // Function to detect user's platform
        function detectPlatform() {
            const userAgent = navigator.userAgent.toLowerCase();
            if (/android/.test(userAgent)) {
                return 'android';
            } else if (/iphone|ipad|ipod/.test(userAgent)) {
                return 'ios';
            }
            return 'unknown';
        }

        // Redirect function
        function redirectToApp() {
            const urlParams = new URLSearchParams(window.location.search);
            const forcePlayMarket = urlParams.get('playmarket') === 'true';
            
            let redirectUrl;
            
            if (forcePlayMarket) {
                // Force redirect to Play Store if playmarket=true
                redirectUrl = PLAY_STORE_URL;
                document.getElementById('redirectMessage').textContent = 'Redirecting to Google Play Store...';
            } else {
                // Detect platform and redirect accordingly
                const platform = detectPlatform();
                
                switch (platform) {
                    case 'android':
                        redirectUrl = PLAY_STORE_URL;
                        document.getElementById('redirectMessage').textContent = 'Redirecting to Google Play Store...';
                        break;
                    case 'ios':
                        redirectUrl = APP_STORE_URL;
                        document.getElementById('redirectMessage').textContent = 'Redirecting to App Store...';
                        break;
                    default:
                        // For desktop or unknown platforms, use the original redirect
                        const currentParams = new URLSearchParams(window.location.search);
                        redirectUrl = `${DEFAULT_REDIRECT_URL}?${currentParams.toString()}`;
                        document.getElementById('redirectMessage').textContent = 'Redirecting to Eduport...';
                        break;
                }
            }
            
            // Add any additional parameters from the current URL (except playmarket)
            if (redirectUrl === PLAY_STORE_URL || redirectUrl === APP_STORE_URL) {
                const params = new URLSearchParams(window.location.search);
                params.delete('playmarket'); // Remove playmarket parameter for app store URLs
                
                if (params.toString()) {
                    const separator = redirectUrl.includes('?') ? '&' : '?';
                    redirectUrl = `${redirectUrl}${separator}${params.toString()}`;
                }
            }
            
            // Perform redirection
            window.location.href = redirectUrl;
        }

        // Execute redirection on page load
        window.addEventListener('load', redirectToApp);
    </script>
</body>
</html>
